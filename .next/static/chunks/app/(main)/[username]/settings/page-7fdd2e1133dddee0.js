(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6777],{54287:function(){},97513:function(e,n,a){Promise.resolve().then(a.bind(a,1228))},1300:function(e,n,a){"use strict";var s=a(57437);a(2265),a(45213),a(40222);var t=a(30998),i=a(16463);n.Z=function(e){let{children:n}=e,{data:a}=(0,t.useSession)({required:!0,onUnauthenticated(){(0,i.redirect)("/signup")}});return(0,s.jsx)(s.Fragment,{children:a&&n})}},36471:function(e,n,a){"use strict";var s=a(57437),t=a(2265);a(24931);var i=a(41648),l=a(12623),r=a(87138);n.Z=function(e){let{closePopup:n,popupContent:a,user:c,previewArticleDetails:o,copyPreviewLink:d,updateProfile:u}=e,[p,m]=(0,t.useState)(null==c?void 0:c.name),[h,v]=(0,t.useState)(null==c?void 0:c.username),[x,j]=(0,t.useState)(null==c?void 0:c.url),[f,g]=(0,t.useState)(null==c?void 0:c.bio),[C,N]=(0,t.useState)(null==c?void 0:c.avatar),[w,E]=(0,t.useState)(null),[y,S]=(0,t.useState)(!1),P=(0,t.useRef)(null),b=()=>{u({name:p,bio:f,url:x,username:h,file:w})};return(0,s.jsxs)("div",{className:"popupContainer",style:{height:"followList"==a&&"100%"},children:[(0,s.jsx)("div",{className:"popupcloserdiv",onClick:()=>n()}),(0,s.jsxs)("div",{className:"popupContent",children:["editProfile"===a&&(0,s.jsxs)("div",{className:"editProfilePopup",children:[(0,s.jsxs)("div",{className:"popupHeader",children:[(0,s.jsx)("h3",{children:"Profile Information"}),(0,s.jsx)("span",{onClick:()=>n(),children:(0,s.jsx)(i.Z,{})})]}),(0,s.jsxs)("div",{className:"updatePhoto",children:[(0,s.jsx)("div",{style:{background:"url(".concat(C,")")},className:"currentProfilePhoto"}),(0,s.jsxs)("div",{className:"photoActions",children:[(0,s.jsx)("span",{onClick:()=>P.current.click(),children:"Update"})," ",(0,s.jsx)("span",{children:"Remove"})]}),y&&(0,s.jsx)("span",{style:{cursor:"pointer"},onClick:()=>{N(null==c?void 0:c.avatar),S(!1),E(null)},children:"revert"}),(0,s.jsx)("input",{type:"file",name:"profilephoto",id:"profilephoto",ref:P,style:{display:"none"},accept:"image/jpeg, image/png",onChange:e=>{let n=e.target.files[0];N(URL.createObjectURL(n)),E(n),S(!0)}})]}),(0,s.jsxs)("div",{className:"updateField",children:[(0,s.jsx)("span",{children:"Name"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter updated name",value:p,onChange:e=>m(e.target.value)}),(0,s.jsx)("small",{children:"Appears on your profile"})]}),(0,s.jsxs)("div",{className:"updateField",children:[(0,s.jsx)("span",{children:"username"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter updated username",value:h,onChange:e=>v(e.target.value)}),(0,s.jsx)("small",{children:"Appears on your profile"})]}),(0,s.jsxs)("div",{className:"updateField",children:[(0,s.jsx)("span",{children:"Bio"}),(0,s.jsx)("textarea",{type:"text",placeholder:"Enter Bio",value:f,onChange:e=>g(e.target.value)}),(0,s.jsx)("small",{children:"Appears on your profile"})]}),(0,s.jsxs)("div",{className:"updateField",children:[(0,s.jsx)("span",{children:"Bio URL"}),(0,s.jsx)("input",{type:"text",placeholder:"Enter Bio URL (https://example.com)",value:x,onChange:e=>j(e.target.value)}),(0,s.jsx)("small",{children:"Appears on your profile"})]}),(0,s.jsxs)("div",{className:"updateProfileBtns",children:[(0,s.jsx)("button",{onClick:()=>n(),className:"cancel",children:"Cancel"}),(0,s.jsx)("button",{className:"save",onClick:()=>b(),children:"Save"})]})]}),"previewCodeUrl"===a&&(0,s.jsxs)("div",{className:"editProfilePopup previewCodeUrlPopup",children:[(0,s.jsx)("h1",{className:"previewCodeUrlTitle",children:"Your Preview Link Is Ready!"}),(0,s.jsx)("p",{children:"Share this link with friends/editors to look at your article."}),(0,s.jsx)("span",{className:"previewCodeText",children:"Preview Code"}),(0,s.jsx)("p",{className:"previewCode",children:o.code}),(0,s.jsx)("span",{className:"previewLink",children:o.url}),(0,s.jsx)("small",{children:"*You can still access these details in your Drafts page."}),(0,s.jsxs)("div",{className:"previewCodeUrlBtns",children:[(0,s.jsxs)("button",{onClick:()=>d(o.url),children:[" ",(0,s.jsx)(l.Z,{})," Copy Url"]}),(0,s.jsx)(r.default,{href:"/",children:(0,s.jsxs)("button",{className:"cancelBtn",onClick:()=>n(),children:[" ","Close"]})})]})]}),"followList"===a&&(0,s.jsxs)("div",{className:"followsContainer",children:[(0,s.jsxs)("div",{className:"followsHeader",children:[(0,s.jsx)("span",{children:"Followers"}),(0,s.jsx)("span",{children:"x"})]}),(0,s.jsxs)("div",{className:"followItem",children:[(0,s.jsx)("div",{className:"followAvatar"}),(0,s.jsxs)("div",{className:"followInfo",children:[(0,s.jsx)("span",{className:"followName",children:"Demo Name"}),(0,s.jsx)("span",{className:"followUsername",children:"@demoUsername"})]}),(0,s.jsx)("div",{className:"followActionBtn",children:"Action"})]})]})]})]})}},1228:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return x}});var s=a(57437);a(88058);var t=a(2265),i=a(57135),l=a.n(i),r=a(1300),c=a(36471),o=a(28644),d=a(86261),u=a(65548),p=a(30998),m=a(16463);a(69533);var h=function(){return(0,s.jsx)("div",{className:"loadingArea"})},v=a(20357),x=function(e){let{params:n}=e,{data:a,update:i}=(0,p.useSession)(),[x,j]=(0,t.useState)({}),[f,g]=(0,t.useState)("account"),[C,N]=(0,t.useState)(!1),[w,E]=(0,t.useState)(""),[y,S]=(0,t.useState)(!1),P=(0,t.useRef)(null);(0,m.useRouter)();let[b,_]=(0,t.useState)(null==x?void 0:x.name),[k,A]=(0,t.useState)(null==x?void 0:x.username),[U,I]=(0,t.useState)(null==x?void 0:x.url),[T,B]=(0,t.useState)(null==x?void 0:x.bio),L=async e=>{let n=v.env.NEXT_PUBLIC_AWS_BUCKET_NAME,a=v.env.NEXT_PUBLIC_AWS_BUCKET_REGION,s=v.env.NEXT_PUBLIC_AWS_ACCESS_KEY,t=v.env.NEXT_PUBLIC_AWS_SECRET_KEY,i=new o.g({region:a,credentials:{accessKeyId:s,secretAccessKey:t}}),l={Bucket:n,Key:"avatars/".concat(null==x?void 0:x.email,"_avatar.jpg"),Body:e,contentType:"image/jpeg"},r=new d.U(l);await i.send(r)},R=async e=>{let n=v.env.NEXT_PUBLIC_AWS_BUCKET_NAME,a=v.env.NEXT_PUBLIC_AWS_BUCKET_REGION,s=v.env.NEXT_PUBLIC_AWS_ACCESS_KEY,t=v.env.NEXT_PUBLIC_AWS_SECRET_KEY,i=new o.g({region:a,credentials:{accessKeyId:s,secretAccessKey:t}}),l={Bucket:n,Key:"images/".concat(F(e),".jpg")},r=new u.C(l),c=await i.send(r);return console.log(c),c.$metadata},F=e=>{let n=e.split("/");return n[n.length-1].split(".")[0]};(0,t.useEffect)(()=>{console.log(a),K()},[a]),(0,t.useEffect)(()=>{(null==a?void 0:a.username)!==(null==n?void 0:n.username)&&(0,m.redirect)("/")},[a]);let K=async()=>{let e=await fetch("/api/users/actions.php?action=getUser&username=".concat(null==a?void 0:a.username)),n=await e.json();j(n=n.data),_(null==n?void 0:n.name),A(null==n?void 0:n.username),B(null==n?void 0:n.bio),I(null==n?void 0:n.url)},z=async e=>{let n=new FormData;if(console.log(e),S(!0),P.current=null==x?void 0:x.avatar,null!==e.file){var s;await R(null==x?void 0:x.avatar),await L(e.file),P.current=(s="".concat(null==x?void 0:x.email,"_avatar"),"https://reedboss.s3.us-east-2.amazonaws.com/avatars/".concat(s,".jpg"))}e.username=e.username.replaceAll(" ",""),n.append("action","updateProfile"),n.append("userId",null==a?void 0:a.id),n.append("name",e.name),n.append("username",e.username),n.append("bio",e.bio),n.append("url",e.url),n.append("avatar",P.current),n.append("allowEmails",null==x?void 0:x.allowEmails);let t=await fetch("/api/users/actions.php",{method:"POST",body:n});console.log(await t.json()),await i({...a,name:e.name,username:e.username,bio:e.bio,url:e.url,avatar:P.current}),S(!1),alert("Profile Updated, refresh page to see changes"),N(!1),K()};return y?(0,s.jsx)(h,{}):(0,s.jsx)(r.Z,{children:(0,s.jsxs)("div",{className:"settingsContainer ".concat(l().className),children:[C&&(0,s.jsx)(c.Z,{closePopup:()=>N(!1),popupContent:w,user:x,updateProfile:z,setloading:S,setupdateUsername:A}),(0,s.jsxs)("div",{className:"settingsWrapper",children:[(0,s.jsx)("h1",{className:"settingsHeaderText",children:"Settings"}),(0,s.jsxs)("div",{className:"SettingsTabs",children:[(0,s.jsx)("span",{className:"settingsTab ".concat("account"===f?"activeTab":""),onClick:()=>g("account"),children:"Account"}),(0,s.jsx)("span",{className:"settingsTab ".concat("publishing"===f?"activeTab":""),onClick:()=>g("publishing"),children:"Publishing"}),(0,s.jsx)("span",{className:"settingsTab ".concat("notification"===f?"activeTab":""),onClick:()=>g("notification"),children:"Notifications"})]}),(0,s.jsxs)("div",{className:"settingsContent",children:["account"===f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{E("editProfile"),N(!0)},className:"btn",style:{marginBottom:10,width:100},children:"Edit Profile"}),(0,s.jsxs)("div",{onClick:()=>{E("editProfile"),N(!0)},className:"accountField",children:[(0,s.jsx)("span",{children:"Email Address"}),(0,s.jsx)("span",{children:x?x.email:"..."})]}),(0,s.jsxs)("div",{className:"accountField",children:[(0,s.jsx)("span",{children:"Username"}),(0,s.jsxs)("span",{children:["@",x?x.username:"..."]})]}),(0,s.jsxs)("div",{className:"accountField",children:[(0,s.jsx)("span",{children:"Bio"}),(0,s.jsx)("span",{children:"Edit"})]}),(0,s.jsxs)("div",{className:"deleteAccount",children:[(0,s.jsx)("span",{children:"Delete Account"}),(0,s.jsx)("small",{children:"Permanently delete you account and all it's content including articles and comments"})]})]}),"publishing"===f&&(0,s.jsx)("h4",{children:"Accessibility Feature Coming Soon"}),"notification"===f&&(0,s.jsx)("h4",{children:"Accessibility Feature Coming Soon"})]})]})]})})}},45213:function(e,n,a){"use strict";a.d(n,{Lz:function(){return o}});var s=a(62175),t=a.n(s),i=a(70763),l=a(60902),r=a(20357);let c=r.env.API_URL,o={session:{strategy:"jwt"},providers:[(0,i.Z)({clientId:r.env.GOOGLE_CLIENT_ID,clientSecret:r.env.GOOGLE_CLIENT_SECRET}),(0,l.Z)({name:"Credentials",async authorize(e){let{email:n,token:a}=e,s=await fetch("".concat(c,"/users/index.php?email=").concat(n,"&with=token"),{method:"GET",headers:{Authorization:"Bearer "+a}}),t=await s.json();return 200==t.status&&t.data?t.data:null}})],callbacks:{async signIn(e){if("google"==e.account.provider){var n,a,s,t;let i=await fetch("".concat(c,"/users/checkIfUserExists.php?email=").concat(null==e?void 0:null===(n=e.user)||void 0===n?void 0:n.email));return!1!==(await i.json()).message||"/signup?continue=true&email=".concat(null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.email,"&name=").concat(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.name,"&image=").concat(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.image)}return{hello:"world"}},jwt:async e=>{let{token:n,user:a,trigger:s,session:t}=e;if(a){let e=await fetch("".concat(c,"/users/index.php?email=").concat(null==a?void 0:a.email,"&with=token")),s=await e.json();if(console.log("response: "+s),200!==s.status)return n;n={...n,...s.data}}return"update"===s&&n?{...n,...t}:n},session:async e=>{let{session:n,token:a}=e;return a}}};t()(o)},65548:function(e,n,a){"use strict";a.d(n,{C:function(){return r}});var s=a(83451),t=a(10386),i=a(6586),l=a(43337);class r extends i.mY{static getEndpointParameterInstructions(){return{Bucket:{type:"contextParams",name:"Bucket"},ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(e){super(),this.input=e}resolveMiddleware(e,n,a){this.middlewareStack.use((0,t.p2)(n,this.serialize,this.deserialize)),this.middlewareStack.use((0,s.a3)(n,r.getEndpointParameterInstructions()));let i=e.concat(this.middlewareStack),{logger:l}=n,{requestHandler:c}=n;return i.resolve(e=>c.handle(e.request,a||{}),{logger:l,clientName:"S3Client",commandName:"DeleteObjectCommand",inputFilterSensitiveLog:e=>e,outputFilterSensitiveLog:e=>e})}serialize(e,n){return(0,l.ku8)(e,n)}deserialize(e,n){return(0,l.vSB)(e,n)}}},41648:function(e,n,a){"use strict";var s=a(23963);n.Z=void 0;var t=s(a(19118)),i=a(57437),l=(0,t.default)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}),"CloseOutlined");n.Z=l},12623:function(e,n,a){"use strict";var s=a(23963);n.Z=void 0;var t=s(a(19118)),i=a(57437),l=(0,t.default)((0,i.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"}),"InsertLink");n.Z=l},69533:function(){},24931:function(){},88058:function(){}},function(e){e.O(0,[9859,5663,7743,3475,411,8218,8514,3840,998,6300,5632,96,6261,2971,7023,1744],function(){return e(e.s=97513)}),_N_E=e.O()}]);